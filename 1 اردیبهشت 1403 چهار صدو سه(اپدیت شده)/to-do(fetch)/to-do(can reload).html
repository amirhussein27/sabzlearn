<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body{
    text-align: center;
    background-color: lightslategray;
}
div.container {
    text-align: center;
    margin-top: 14%;
  }
  
  ul.myUL {
    display: inline-block;
    text-align: left;
    list-style-type:none;
    width: 300px;
    color: black;
    cursor: pointer;
  }
  #trash:hover{
    color: red;
  }
  #trash{
    color: #fff;
    float: right;
    position: relative;
    margin-top: -20px;
    cursor: pointer;
    padding: 2px;
    background-color: lightsalmon;
    border-radius: 5%;
  }
  input{
    width: 260px;
  }
  h2{
    color: aliceblue;
  }
  h3{
    cursor: pointer;
    color:darkred;
  }
  li{
    line-height: 40px;
  }
</style>
</head>
<body>

<div id="container" class="container">
  <input id="myinp" type="text" placeholder="insert new task and press enter">
<button id="addme">add</button>
  <h2>to do list</h2>
  <p style="color: aliceblue;">(click on task if done)</p>
<h3 id="deleteme">delete all tasks<i class="fa fa-trash"></i></h3>
  <ul id="myul" class="myUL"> 
    <!-- <li>Coffee<i id="trash" class="fa fa-trash"></i>
</li>
    <li>Teadsffffffff<i id="trash" class="fa fa-trash"></i>
</li>
    <li>Coca Cola<i id="trash" class="fa fa-trash"></i></li></i> -->
    
  </ul>
  
</div>

<script>
   let myinp=document.getElementById("myinp")
let myUL=document.getElementsByClassName("myUL")
let container=document.getElementById("container")
let myul=document.getElementById("myul")
let fafa=document.getElementsByClassName('fa fa-remove')
let userid=null

  window.addEventListener('load',()=>{
    fetch('https://amirsimple1-7c419-default-rtdb.firebaseio.com/products.json')
  .then(res=>res.json())
  .then(data=>{
    let todos=Object.entries(data)
    console.log(todos);
    todos.forEach(user=>{
      console.log(user[0]);
      
      myul.insertAdjacentHTML('beforeend',`<li id="nli">${user[1]}
<br><button id="trash" class="fa fa-remove" onclick="opendeletemodal('${user[0]}')"></button></li>
    `)
    })
    let trash2=document.getElementById("trash")
    let nli=document.getElementById("nli")
    trash2.addEventListener('click',function(){
      console.log("ssss");
      trash2.remove()
      nli.remove()
    })
console.log(fafa.length);
for(i=0;i<fafa.length;i++){
  fafa[i].addEventListener('click',function(){
  console.log(event.target);
})
}



  })
  })
 

function addnewdo(newdo){
  
// console.log(trash);

if(myinp.value==""){
    alert("emptytext")
}
else{console.log(newdo);

  let todos=myinp.value
  fetch('https://amirsimple1-7c419-default-rtdb.firebaseio.com/products.json',{
    method:'post',
    headers:{
      "content-type":"application/json"
    },body:JSON.stringify(todos)
  })
    let newdoli=document.createElement('li')
    newdoli.id="newli"

    let newicon=document.createElement('li')
    newicon.id="newli"
    newicon.className='fa fa-square-o'

    let trash1=document.createElement('li')
    // console.log(newdotrash);
    let newhr=document.createElement('hr')
    


    let newcheck=document.createElement('li')
    newcheck.id="newli"
    newcheck.className='fa fa-check'
    newdoli.append(newcheck)
    newcheck.style.display="none"
    
    
    trash1.className='fa fa-remove'
    trash1.id="trash"
    console.log(trash1);
    
    newdoli.innerHTML=newdo
    container.append()
    
    myul.append(newdoli,trash1,newcheck)



    
    trash1.addEventListener('click',function(){
        newdoli.remove()
        trash1.remove()
        newhr.remove()
        newcheck.remove()
    })
    deleteme.addEventListener('click',function(){
        newdoli.remove()
        trash1.remove()
        newhr.remove()
       })
       
       newdoli.addEventListener('click',function(){
        if( newdoli.style.textDecoration!="line-through"){  
              newdoli.style.textDecoration="line-through"
              newdoli.style.opacity=0.35
        newcheck.style.display="block"
        // newcheck.style.textDecoration="none"

      
            //   newicon.remove()

            //   fa fa-check
    }
    else{
        newdoli.style.textDecoration="none"
        newdoli.style.color="black"
        newdoli.style.opacity=1
        newcheck.style.display="none"


        
    }
    
       }
       
       )
       myinp.value=''
    }

   }


addme.addEventListener('click',function(event){
  
let newdo=myinp.value
    

    // console.log("object");

    // console.log(event.keyCode);


addnewdo(newdo)

        })
   function opendeletemodal(id){
          id=userid
event.target.parentElement.remove()
console.log(userid);
fetch('https://amirsimple1-7c419-default-rtdb.firebaseio.com/products/'+userid+'.json',{
    method:'DELETE'
  }).then(res=>console.log(res))
        }
  
</script>
</body>
</html>
